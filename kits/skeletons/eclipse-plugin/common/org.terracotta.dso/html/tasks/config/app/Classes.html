<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta name="copyright" content="Copyright (c) Terracotta 2005, 2006.">
<LINK REL="STYLESHEET" HREF="../../../book.css" CHARSET="ISO-8859-1" TYPE="text/css">
  <title>Specifying Instrumented Classes</title>
</head>

<body>
<H4>Instrumented Classes</H4>
<p>Any class that contains a field you would like to make a shared root or is a type whose instances will be part of a shared object graph must be instrumented by DSO. You can specify which classes in your project are to be instrumented in the <code>Instrumented Classes</code> tab of the DSO Config page of the Terracotta Config editor.<BR><BR>
<img src="instrumented_classes.jpg" border=1>
<H4>Instrumentation Rules</H4>
The Instrumented classes tab lets you define rules for specifying which classes are instrumented by DSO. There are two types of rules: include and exclude. An include rule indicates that the specified classes are to be instrumented and lets you specify additional attributes to be assigned to the instrumented classes. An exclude rule indicates that the specified classes are <b>not</b> to be instrumented. It really only makes sense to exclude classes from a set that has previously been included.
<H4>Additional Include Attributes</H4>
<p>Instances of instrumented classes may be shared.  To indicate to DSO that any Java transient fields of a shared instance should not be shared, select the <b>Honor transient</b> checkbox. By default DSO includes all fields of a shared object for replication. In addition to fields marked as Java transient, a shared object may contain other fields that aren't appropriate for transparent replication. Those fields should be marked as DSO <a href="Transient_fields.html">Transient Fields</a>. One way or the other, those transient fields need to get re-initialized when a new copy of a shared object is materialized on a client. You can use the <b>On load</b> button to specify a method to invoke or some BeanShell script to execute on the shared instance. These two methods allow you to re-initialize any transient fields needed by a shared object.
<H4>Specifying Instrumentation Rules</H4>
<p>You can manually enter a <a href="#patterns">class pattern</a> or select a class or package-fragment from a chooser. Alternately, you can select the class in the Package Explorer or Outline View, invoke the <code>Terracotta</code> context menu and choose <code>Instrumented</code>.<BR>
<H4>Excluded Classes</H4>
<p>In addition to specifying which classes are to be instrumented, you can also specify classes that are to be excluded from instrumentation. This is useful because the pattern language for describing class includes and exclude allows for a shorthand wildcard notation, much like regular expressions. For convenience, you can specify that all classes under a particular package-fragment be instrumented. If there are actually some classes in that set that should not be instrumented, you can explicitly exclude them.<p>
<p>You can manually enter an excluded class pattern or select a class or package-fragment from a chooser. Alternately, you can select a class or package-fragment in the Workspace Explorer or Outline View, invoke the <code>Terracotta</code> context menu and choose <code>Excluded</code>.
<p>A DSO instrumented class appears in the Project Explorer or Outline View with a red check adorning its label. An excluded class is adorned with a red crossmark.<BR>
<H4>Instrumentation Rule Precedence</H4>
<p>The order of your instrumentation rules (include or exclude) are significant, earlier rules are superceded by later rules. You can change the order of an instrumentation rule by selecting it and using the arrow buttons to move the rule up or down the list.
<H4><a name="patterns">The Pattern Language</a></H4>
<p>The pattern language for specifying the set of your classes to be instrumented or excluded is based on those used in Aspect-oriented Programming frameworks for specify pointcuts.  The following are valid instrumentation <i>include</i> and <i>exclude</i> patterns:<BR><BR>
<table border="1" cellpadding="1" cellspacing="1">
 <tr>
   <td><code>com.project.Main</code></td>
   <td>specifies only class <code>Main</code> in <code>com.project</code></td>
 </tr>
 <tr>
   <td><code>com.project.*</code></td>
   <td>specifies all classes in <code>com.project</code></td>
 </tr>
 <tr>
   <td><code>com.project.*Main</code></td>
   <td>specifies all classes in <code>com.project</code> ending with <code>Main</code></td>
 </tr>
 <tr>
   <td><code>com..*</code></td>
   <td>specifies all classes under <code>com</code></td>
  </tr>
</table><BR>
<p>For the complete description refer to the <a href="http://aspectwerkz.codehaus.org/definition_issues.html#Join_point_selection_pattern_language">Aspectwerks joinpoint selection pattern language</a>.
<p>For more information on the concept of class instrumentation refer to <a href="../../../concepts/Instrumentation.html">DSO Class Instrumentation</a>.
<BR><BR><BR>
</body>
</html>
